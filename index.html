<!DOCTYPE html>
<html>
<head>
  <title>React first app</title>
  <link rel="stylesheet" type="text/css" href="app/css/css.css">
  <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
</head>
<body>

  <div id="example"></div>


  <script type="text/babel">
  class Field extends React.Component{
    constructor(props){
      super(props);
      this.state = {
        tasks: [],
      };
    };
    
    add = (text) => {
      let arr = this.state.tasks;
      arr.push(text);
      this.setState({tasks: arr});
    };
    
    deleteTask = (i) => {
      let arr = this.state.tasks;
      arr.splice (i, 1);
      this.setState ({tasks: arr});
    };

    editText = (text, i) => {
      let arr = this.state.tasks;
      arr[i] = text;
      this.setState ({tasks: arr});
    };
    
    render(){
      return(
        <div className="field">
          <button onClick={this.add.bind(null, 'Your task')} className="add">Add Task</button>
          {this.state.tasks.map((item, i) => {
            return (
              <Task key={i} index={i} edit={this.editText} deleteTask={this.deleteTask}>{item}</Task>
            )}
          )}
        </div>
      );
    }
  }

 
  class Task extends React.Component{
    constructor(props){
      super(props);
      this.state = {
        edit: false,
      };
    };
    edit = () => {
      this.setState({edit: true});
    };
    remove = () =>{
      this.props.deleteTask(this.props.index);
    }; 
    save = () => {
      let jsValue = document.querySelector('textarea').value;
      let refValue = this.refs.textarea.value;
      this.props.edit (refValue, this.props.index);
      this.setState({edit: false});
    };
    renderNormal = () =>{
      return (
        <div className="task">
          <h1 className="text">{this.props.children}</h1>
          <button onClick={this.edit} className="btn light">Edit</button>
          <button onClick={this.remove} className="btn red">Delete</button>
        </div>
      );
    };
    renderEditinig = () =>{
      return (
        <div className="task">
          <textarea className="textarea" ref="textarea" defaultValue={this.props.children}></textarea>
          <button onClick={this.save} className="btn blue">Save</button>
        </div>
      );
    };

    render(){
      if(this.state.edit){
        return this.renderEditinig();
      } else{
        return this.renderNormal();
      }
    }
  }



  ReactDOM.render (
    <Field />, 
    document.getElementById("example")
  );
  </script>
  
</body>
</html>